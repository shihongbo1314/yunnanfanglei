(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a9e5e00"],{4766:function(e,t,i){},"84fc":function(e,t,i){"use strict";i.r(t);var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container",staticStyle:{height:"100%"}},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[i("div",[e._v(" 公告管理列表 "+e._s(e.total)+" 条 ")]),i("div",[i("el-form-item",[i("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.onblur(1)}}},[e._v("查询")])],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.dialog.innerVisible=!0}}},[e._v("添加")])],1)],1)]),i("div",{staticClass:"content"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":"",height:"70vh"}},[i("el-table-column",{attrs:{align:"center",label:"ID",width:"95",type:"index"}}),i("el-table-column",{attrs:{label:"标题",align:"left",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{width:"85%"}},[e._v(" "+e._s(t.row.title)+" ")])]}}])}),i("el-table-column",{attrs:{label:"内容"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"textarea",staticStyle:{width:"100%"},domProps:{innerHTML:e._s(t.row.content)}})]}}])}),i("el-table-column",{attrs:{align:"center",label:"信息类型",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("statusFilter")(t.row.msgType)))])]}}])}),i("el-table-column",{attrs:{align:"center",label:"公告范围",width:"105"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("statusFiltertwo")(t.row.visibleType)))])]}}])}),i("el-table-column",{attrs:{label:"是否启用",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"1","inactive-value":"0"},on:{change:function(i){return e.getChange(t.row)}},model:{value:t.row.enable,callback:function(i){e.$set(t.row,"enable",i)},expression:"scope.row.enable"}})]}}])}),i("el-table-column",{attrs:{align:"center",prop:"created_at",label:"编辑",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),i("Page",{attrs:{total:e.total,pageNum:e.current,pageSize:e.size},on:{pageChange:e.pageChange}})],1),i("el-dialog",{attrs:{width:"1080px",title:"添加公告信息",visible:e.dialog.innerVisible,"append-to-body":""},on:{"update:visible":function(t){return e.$set(e.dialog,"innerVisible",t)},close:e.closeBox}},[i("el-form",{ref:"ruleForm",attrs:{"label-position":e.labelPosition,"label-width":"70px",model:e.formLabelAlign}},[i("el-form-item",{attrs:{label:"标题：",prop:"name"}},[i("el-input",{model:{value:e.formLabelAlign.title,callback:function(t){e.$set(e.formLabelAlign,"title",t)},expression:"formLabelAlign.title"}})],1),i("el-row",{attrs:{type:"flex",justify:"space-between"}},[i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"信息类型：",prop:"msgType","label-width":"95px"}},[i("el-radio-group",{model:{value:e.formLabelAlign.msgType,callback:function(t){e.$set(e.formLabelAlign,"msgType",t)},expression:"formLabelAlign.msgType"}},[i("el-radio",{attrs:{label:1,border:"",size:"medium"}},[e._v("管理类")]),i("el-radio",{attrs:{label:2,border:"",size:"medium"}},[e._v("业务类")])],1)],1)],1),i("el-col",{attrs:{span:14}},[i("el-form-item",{attrs:{label:"公告范围：",prop:"visibleType","label-width":"85px"}},[i("el-radio-group",{model:{value:e.formLabelAlign.visibleType,callback:function(t){e.$set(e.formLabelAlign,"visibleType",t)},expression:"formLabelAlign.visibleType"}},["1"==e.sessionNamelevel&&"管理员"==e.sessionName?i("el-radio",{attrs:{label:1,border:"",size:"medium"}},[e._v("全部可见")]):e._e(),"1"==e.sessionNamelevel||"2"==e.sessionNamelevel||"3"==e.sessionNamelevel?i("el-radio",{attrs:{label:2,border:"",size:"medium"}},[e._v("本级可见")]):e._e(),"1"==e.sessionNamelevel||"2"==e.sessionNamelevel?i("el-radio",{attrs:{label:3,border:"",size:"medium"}},[e._v("本级及下一级可见")]):e._e()],1)],1)],1)],1),i("el-form-item",{attrs:{label:"内容：",prop:"password"}},[i("Editor",{attrs:{editorContent:e.formLabelAlign.content},on:{hangdleEditor:e.hangdleEditor}})],1),i("el-form-item",{staticStyle:{"text-align":"right"}},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialog.innerVisible=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitForm}},[e._v("保存")])],1)],1)],1),i("el-dialog",{attrs:{width:"1080px",title:"编辑公告信息",visible:e.dialogone.innerVisible,"append-to-body":""},on:{"update:visible":function(t){return e.$set(e.dialogone,"innerVisible",t)},close:e.closeBox}},[i("el-form",{ref:"ruleForm",attrs:{"label-position":e.labelPosition,"label-width":"70px",model:e.formLabel}},[i("el-form-item",{attrs:{label:"标题：",prop:"name"}},[i("el-input",{model:{value:e.formLabel.title,callback:function(t){e.$set(e.formLabel,"title",t)},expression:"formLabel.title"}})],1),i("el-row",{attrs:{type:"flex",justify:"space-between"}},[i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"信息类型：",prop:"msgType","label-width":"95px"}},[i("el-radio-group",{model:{value:e.formLabel.msgType,callback:function(t){e.$set(e.formLabel,"msgType",t)},expression:"formLabel.msgType"}},[i("el-radio",{attrs:{label:"1",border:"",size:"medium"}},[e._v("管理类")]),i("el-radio",{attrs:{label:"2",border:"",size:"medium"}},[e._v("业务类")])],1)],1)],1),i("el-col",{attrs:{span:14}},[i("el-form-item",{attrs:{label:"公告范围：",prop:"visibleType","label-width":"85px"}},[i("el-radio-group",{model:{value:e.formLabel.visibleType,callback:function(t){e.$set(e.formLabel,"visibleType",t)},expression:"formLabel.visibleType"}},["1"==e.sessionNamelevel&&"管理员"==e.sessionName?i("el-radio",{attrs:{label:"1",border:"",size:"medium"}},[e._v("全部可见")]):e._e(),"1"==e.sessionNamelevel||"2"==e.sessionNamelevel||"3"==e.sessionNamelevel?i("el-radio",{attrs:{label:"2",border:"",size:"medium"}},[e._v("本级可见")]):e._e(),"1"==e.sessionNamelevel||"2"==e.sessionNamelevel?i("el-radio",{attrs:{label:"3",border:"",size:"medium"}},[e._v("本级及下一级可见")]):e._e()],1)],1)],1)],1),i("el-form-item",{attrs:{label:"内容：",prop:"password"}},[i("Editor",{attrs:{editorContent:e.formLabel.content},on:{hangdleEditor:e.hangdleEditor}})],1),i("el-form-item",{staticStyle:{"text-align":"right"}},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.preserve}},[e._v("保存")]),i("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogone.innerVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},n=[],o=(i("b0c0"),i("c24f")),a=i("3e51"),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("vue-editor",{model:{value:e.editorContent_,callback:function(t){e.editorContent_=t},expression:"editorContent_"}})],1)},r=[],c=i("5873"),d={data:function(){return{curEditorContent:""}},props:["editorContent"],watch:{editorContent:function(e){this.curEditorContent=e}},computed:{editorContent_:{get:function(){return this.editorContent},set:function(e){this.$emit("hangdleEditor",e)}}},components:{VueEditor:c["a"]}},m=d,u=i("2877"),b=Object(u["a"])(m,s,r,!1,null,"3edd1d9a",null),f=b.exports,p={filters:{statusFilter:function(e){var t={1:"管理类",2:"业务类"};return t[e]},statusFiltertwo:function(e){var t={1:"全部可见",2:"本级可见",3:"本级及下一级可见"};return t[e]}},data:function(){return{list:null,listLoading:!0,size:10,current:1,total:0,trueName:"shengguanli",regionId:"",roleId:"",state:"",formInline:{name:""},formLabelAlign:{title:"",content:"",msgType:1,visibleType:2},formLabel:{title:"",content:"",id:""},labelPosition:"right",dialog:{innerVisible:!1},dialogone:{innerVisible:!1},regionIdList:[]}},computed:{sessionNamelevel:function(){var e=JSON.parse(sessionStorage.getItem("records"));return e.roleIdMap.level},sessionName:function(){var e=JSON.parse(sessionStorage.getItem("records"));return e.roleIdMap.name}},components:{Page:a["a"],Editor:f},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;this.listLoading=!0,Object(o["v"])({size:this.size,current:this.current}).then((function(t){e.list=t.data.records,e.total=e.list.length,e.listLoading=!1}))},onblur:function(e){var t=this;this.listLoading=!0,Object(o["v"])({size:this.size,current:e,title:this.formInline.name}).then((function(e){t.list=e.data.records,t.total=e.data.total,t.listLoading=!1}))},hangdleEditor:function(e){this.formLabel.content=e,this.formLabelAlign.content=e},pageChange:function(e){this.size=e._pageSize,this.current=e._currentPage,this.onblur(this.current)},handleEdit:function(e,t){this.dialogone.innerVisible=!0,this.formLabel=t,console.log(this.formLabel),this.formLabel.content=t.content},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["i"])({id:e.id}).then((function(e){200==e.data.state&&"成功"==e.data.stateStr?(t.$message.success("删除成功"),t.fetchData()):t.$message.error("删除失败")}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},preserve:function(){var e=this,t=JSON.parse(sessionStorage.getItem("records"));Object(o["e"])({title:this.formLabel.title,content:this.formLabel.content,id:this.formLabel.id,userid:t.id,msgType:this.formLabel.msgType,regionId:t.regionIdMap.id,visibleType:this.formLabel.visibleType}).then((function(t){"成功"==t.data.stateStr&&(e.$message.success("修改成功"),e.dialogone.innerVisible=!1,e.formLabelAlign={},e.formLabel={},e.fetchData())}))},closeBox:function(){this.dialog.innerVisible=!1},submitForm:function(){var e=this,t=JSON.parse(sessionStorage.getItem("records"));null!=this.formLabelAlign.title&&""!=this.formLabelAlign.title?Object(o["e"])({title:this.formLabelAlign.title,content:this.formLabelAlign.content,msgType:this.formLabelAlign.msgType,regionId:t.regionIdMap.id,visibleType:this.formLabelAlign.visibleType}).then((function(t){"成功"==t.data.stateStr&&(e.$message.success("添加成功"),e.formLabelAlign={},e.formLabel={},e.closeBox(),e.fetchData())})):this.$message.error("添加失败，不能为空")},getChange:function(e){var t=this,i=sessionStorage.getItem("records").id;Object(o["e"])({title:this.formLabelAlign.title,content:this.formLabelAlign.content,userid:i,id:e.id,enable:e.enable}).then((function(e){"成功"==e.data.stateStr&&(t.$message.success("修改成功"),t.closeBox(),t.fetchData())}))}}},g=p,h=(i("d386"),Object(u["a"])(g,l,n,!1,null,"13d330a0",null));t["default"]=h.exports},d386:function(e,t,i){"use strict";i("4766")}}]);