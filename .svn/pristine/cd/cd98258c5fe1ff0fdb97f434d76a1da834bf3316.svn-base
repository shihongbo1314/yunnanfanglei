(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-89106c4e"],{"0f31":function(e,t,s){},"63c5":function(e,t,s){},8989:function(e,t,s){"use strict";s("63c5")},a9e3:function(e,t,s){"use strict";var i=s("83ab"),a=s("da84"),n=s("94ca"),r=s("6eeb"),o=s("5135"),c=s("c6b6"),d=s("7156"),l=s("c04e"),u=s("d039"),p=s("7c73"),m=s("241c").f,g=s("06cf").f,f=s("9bf2").f,v=s("58a8").trim,h="Number",_=a[h],b=_.prototype,x=c(p(b))==h,S=function(e){var t,s,i,a,n,r,o,c,d=l(e,!1);if("string"==typeof d&&d.length>2)if(d=v(d),t=d.charCodeAt(0),43===t||45===t){if(s=d.charCodeAt(2),88===s||120===s)return NaN}else if(48===t){switch(d.charCodeAt(1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+d}for(n=d.slice(2),r=n.length,o=0;o<r;o++)if(c=n.charCodeAt(o),c<48||c>a)return NaN;return parseInt(n,i)}return+d};if(n(h,!_(" 0o1")||!_("0b1")||_("+0x1"))){for(var I,N=function(e){var t=arguments.length<1?0:e,s=this;return s instanceof N&&(x?u((function(){b.valueOf.call(s)})):c(s)!=h)?d(new _(S(t)),s,N):S(t)},C=i?m(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),M=0;C.length>M;M++)o(_,I=C[M])&&!o(N,I)&&f(N,I,g(_,I));N.prototype=b,b.constructor=N,r(a,h,N)}},ad9d:function(e,t,s){"use strict";var i=s("23e7"),a=s("1d80"),n=s("44e7"),r=s("ad6d"),o=s("b622"),c=s("c430"),d=o("replace"),l=RegExp.prototype;i({target:"String",proto:!0},{replaceAll:function e(t,s){var i,o,u,p,m,g,f,v,h,_=a(this);if(null!=t){if(i=n(t),i&&(o=String(a("flags"in l?t.flags:r.call(t))),!~o.indexOf("g")))throw TypeError("`.replaceAll` does not allow non-global regexes");if(u=t[d],void 0!==u)return u.call(t,_,s);if(c&&i)return String(_).replace(t,s)}if(p=String(_),m=String(t),""===m)return e.call(p,/(?:)/g,s);if(g=p.split(m),"function"!==typeof s)return g.join(String(s));for(f=g[0],v=f.length,h=1;h<g.length;h++)f+=String(s(m,v,p)),v+=m.length+g[h].length,f+=g[h];return f}})},bb09:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message"},[s("div",{staticClass:"message-header"},[s("div",[e._v("消息中心")]),s("el-tooltip",{attrs:{content:"一键已读",placement:"bottom",effect:"light"}},[s("el-button",{staticStyle:{"margin-right":"10px"},attrs:{circle:""},on:{click:e.Aread}},[s("svg-icon",{attrs:{"icon-class":"saoba"}})],1)],1)],1),s("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{name:"first"}},[s("span",{attrs:{slot:"label"},slot:"label"},[e._v("项目通知"),this.$store.state.app.length>0?s("el-badge",{attrs:{value:this.$store.state.app.length,max:9}}):e._e()],1),s("div",{staticClass:"message-body"},[s("div",{staticClass:"boxs"},e._l(e.messageList,(function(t,i){return s("el-card",{key:i,staticClass:"box-card"},[s("el-badge",{staticClass:"item",staticStyle:{width:"100%"},attrs:{"is-dot":"0"==t.read}},[s("div",[s("div",{staticClass:"box-card-box"},[s("div",{staticClass:"card_box"},[e._v(e._s(t.id)+". 审核通知")]),s("div",{staticClass:"card_box2"},[e._v(e._s(t.saveTime))])]),s("div",{staticClass:"box-card-box2"},[s("div",{staticStyle:{"line-height":"28px"}},[e._v(e._s(t.msg))]),s("div",[s("el-button",{attrs:{size:"mini",disabled:null==t.projectMap.original_record_path},on:{click:function(s){return e.original(t.projectMap)}}},[e._v("详细信息")]),"备案人"==e.sessionName||"管理员"==e.sessionName||"编制人"==e.sessionName||"编印人"==e.sessionName?s("el-button",{attrs:{size:"mini",disabled:null==t.projectMap.test_img},on:{click:function(s){return e.detection(t.projectMap.test_img)}}},[e._v("检测报告下载")]):e._e(),"备案人"==e.sessionName||"管理员"==e.sessionName?s("el-button",{attrs:{size:"mini",disabled:null==t.projectMap.contract_file},on:{click:function(s){return e.contract(t.projectMap.contract_file)}}},[e._v("合同下载")]):e._e()],1)])])])],1)})),1),s("Page",{attrs:{total:e.total,pageNum:e.current,pageSize:e.size},on:{pageChange:e.pageChange}})],1)]),s("el-tab-pane",{attrs:{name:"second"}},[s("span",{attrs:{slot:"label"},slot:"label"},[e._v("留言信息 "),e.notice>0?s("el-badge",{attrs:{value:e.notice,max:9}}):e._e()],1),s("div",{staticClass:"messageBox"},e._l(e.message_List,(function(t,i){return s("el-card",{key:i,staticClass:"box-card"},[s("el-badge",{staticClass:"item",staticStyle:{width:"100%"},attrs:{"is-dot":"0"==t.isread}},[s("div",[s("div",{staticClass:"box-card-box"},[s("div",{staticClass:"card_box"},[e._v(e._s(i+1)+"."+e._s(t.number)+" ")]),s("div",{staticClass:"card_box2"},[e._v(e._s(t.saveTime))])]),s("div",{staticClass:"box-card-box2"},[s("div",{staticStyle:{"line-height":"28px"}},[e._v(e._s(t.senderUserMap.trueName)+"："+e._s(t.content))]),s("i",{staticClass:"el-icon-chat-dot-round",on:{click:function(s){return e.BtnClick(t)}}})])])])],1)})),1),e.ishow?s("div",{directives:[{name:"drag",rawName:"v-drag"}],staticClass:"jiaBox"},[s("div",{staticClass:"header"},[e._v("留言栏"),s("i",{staticClass:"el-icon-close",on:{click:e.close}})]),s("div",{ref:"messbox",staticClass:"messbox"},e._l(e.jiaBoxList,(function(t){return s("div",{staticClass:"boxs"},[t.senderUserMap.id!=e.regionId.id?s("div",{staticClass:"leftbox"},[s("span",[e._v(e._s(t.senderUserMap.userName))]),s("span",{staticStyle:{display:"block"}},[e._v(e._s(t.saveTime))]),s("div",{staticClass:"mess_box"},[e._v(" "+e._s(t.content)+" ")])]):s("div",{staticClass:"rightbox"},[s("span",[e._v(e._s(t.senderUserMap.userName))]),s("span",{staticStyle:{display:"block"}},[e._v(e._s(t.saveTime))]),s("div",{staticClass:"mess_box"},[e._v(" "+e._s(t.content)+" ")])])])})),0),s("div",{staticClass:"leaveMess"},[s("el-input",{attrs:{size:"small",placeholder:"请输入内容"},model:{value:e.textarea,callback:function(t){e.textarea=t},expression:"textarea"}}),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.postMessList}},[e._v("发送")])],1)]):e._e()])],1)],1)},a=[],n=(s("b0c0"),s("ac1f"),s("5319"),s("ad9d"),s("c24f")),r=s("3e51"),o={name:"XXX",data:function(){return{total:0,current:1,size:10,messageList:[],activeName:"first",message_List:[],senderUserList:[],jiaBoxList:[],textarea:"",regionId:null,ishow:!1,receiveUserid:"",examineId:"",notice:""}},components:{Page:r["a"]},mounted:function(){this.regionId=JSON.parse(sessionStorage.getItem("records")),this.getMessList(),this.getMessListread()},created:function(){var e=JSON.parse(sessionStorage.getItem("records"));this.projectmsg(e),this.getMsgCount(e)},computed:{sessionName:function(){var e=JSON.parse(sessionStorage.getItem("records"));return e.roleIdMap.name}},methods:{projectmsg:function(e){var t=this;Object(n["r"])({current:this.current,size:this.size,userId:e.id,roleId:e.roleIdMap.id}).then((function(e){t.messageList=e.data.records,t.total=e.data.total}))},pageChange:function(e){var t=JSON.parse(sessionStorage.getItem("records"));this.size=e._pageSize,this.current=e._currentPage,this.projectmsg(t)},original:function(e){"对接人"==this.sessionName||"审核人"==this.sessionName||"终审人"==this.sessionName||"编印人"==this.sessionName?this.$router.push({path:"/aviation/information",query:{number:e.number}}):this.$router.push({path:"/aviation/reference",query:{number:e.number}})},detection:function(e){var t=e.replaceAll("docx","pdf");null!=t&&window.open("http://140.249.209.176:8084/LightningDetection/ProjectTestRecord/"+t)},contract:function(e){null!=e&&window.open("http://140.249.209.176:8084/LightningDetection/Contract/"+e)},Aread:function(){var e=this,t=JSON.parse(sessionStorage.getItem("records"));Object(n["a"])({userId:t.id,roleId:t.roleIdMap.id}).then((function(s){"成功"==s.data.stateStr?(e.$store.commit("app/ALLREAD",!1),e.getMsgCount(t),e.projectmsg(t)):e.$message.error("已读失败")}))},getMsgCount:function(e){var t=this;Object(n["o"])({userId:e.id,roleId:e.roleIdMap.id}).then((function(e){t.$store.commit("app/MESSAGELIST",e.data.records)}))},getMessList:function(e){var t=this,s=JSON.parse(sessionStorage.getItem("records")),i={receiveUserid:s.id};!e&&(i.readOder=1),Object(n["n"])(i).then((function(e){200==e.data.state?(t.message_List=e.data.records,t.senderUserList=e.data.records):t.message_List=[]}))},getMessListread:function(){var e=this,t=JSON.parse(sessionStorage.getItem("records")),s={receiveUserid:t.id,isread:0};Object(n["n"])(s).then((function(t){200==t.data.state?(e.notice=t.data.records.length,e.$store.commit("app/MESSAGELISTTwo",e.notice)):(e.notice=0,e.$store.commit("app/MESSAGELISTTwo",e.notice))}))},getMessLists:function(e,t){var s=this,i=JSON.parse(sessionStorage.getItem("records")),a={receiveUserid:i.id,examineId:e,senderUserid:t};Object(n["n"])(a).then((function(e){200==e.data.state&&(s.jiaBoxList=e.data.records)}))},postMessList:function(){var e=this,t=JSON.parse(sessionStorage.getItem("records"));Object(n["q"])({senderUserid:t.id,receiveUserid:this.receiveUserid,examineId:this.examineId,content:this.textarea}).then((function(t){200==t.data.state&&(e.getMessLists(e.examineId,e.receiveUserid),e.getMessList(!0),e.textarea="",setTimeout((function(){e.$refs.messbox.scrollTop=e.$refs.messbox.scrollHeight}),500))}))},BtnClick:function(e){var t=this;this.ishow=!0,this.receiveUserid=e.senderUserMap.id,this.examineId=e.examineMap.id;var s=JSON.parse(sessionStorage.getItem("records"));setTimeout((function(){t.$refs.messbox.scrollTop=t.$refs.messbox.scrollHeight}),500),Object(n["g"])({examineId:e.examineMap.id,receiveUserid:s.id}).then((function(s){t.getMessLists(e.examineMap.id,e.senderUserMap.id),t.getMessList(!0),t.getMessListread()}))},close:function(){this.ishow=!1}},directives:{clickoutside:{bind:function(e,t,s){function i(s){if(e.contains(s.target))return!1;t.expression&&t.value(s)}function a(e){27==e.keyCode&&t.expression&&t.value(e)}e.__vueClickOutSize__=i,e.__vueKeyup__=a,document.addEventListener("keyup",a),document.addEventListener("click",i)},unbind:function(e,t){document.removeEventListener("click",e.__vueClickOutSize__),delete e.__vueClickOutSize__,document.removeEventListener("keyup",e.__vueKeyup__),delete e.__vueKeyup__}},drag:function(e,t){e.onmousedown=function(t){var s=t.pageX-e.offsetLeft,i=t.pageY-e.offsetTop;document.onmousemove=function(t){e.style.left=t.pageX-s+"px",e.style.top=t.pageY-i+"px"},document.onmouseup=function(){document.onmousemove=document.onmouseup=null}}}}},c=o,d=(s("c0f6"),s("8989"),s("2877")),l=Object(d["a"])(c,i,a,!1,null,"545a6b0b",null);t["default"]=l.exports},c0f6:function(e,t,s){"use strict";s("0f31")}}]);