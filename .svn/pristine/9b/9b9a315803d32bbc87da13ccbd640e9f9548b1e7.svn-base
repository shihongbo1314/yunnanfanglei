(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5dc2eb04"],{"5bc0":function(t,e,i){},"9ed1":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("table",{attrs:{width:"100%",bgcolor:"#cccccc",cellpadding:"1",cellspacing:"1"}},[i("tr",[i("td",{attrs:{valign:"top",width:"80",bgcolor:"white",align:"center"}},[i("table",{attrs:{id:"tablebut"}},[i("tr",[i("td",{attrs:{valign:"top"}},[t._v(" ["),i("b",{staticStyle:{color:"green"}},[t._v("打开保存")]),t._v("]"),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"存为本地文件"},on:{click:function(e){return t.WebSaveLocal()}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"指定页保存"},on:{click:function(e){return t.WebSavePage()}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"删除文件"},on:{click:function(e){return t.WebDelFile()}}}),i("br"),t._v(" ["),i("b",{staticStyle:{color:"green"}},[t._v("文档转换")]),t._v("]"),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"保存本地PDF"},on:{click:function(e){return t.WebSaveLocalPdf()}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"保存本地HTML"},on:{click:function(e){return t.WebSaveLocalHTML()}}}),i("br"),t._v(" ["),i("b",{staticStyle:{color:"green"}},[t._v("打印控制")]),t._v("]"),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"打印预览"},on:{click:function(e){return t.WebDocPrintPreView()}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"设置后打印一"},on:{click:function(e){return t.WebDocPrint()}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"设置后打印二"},on:{click:function(e){return t.WebDocPrint2()}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"直接打印"},on:{click:function(e){return t.WebPrintDirc()}}}),i("br"),t._v(" ["),i("b",{staticStyle:{color:"green"}},[t._v("窗口设置")]),t._v("]"),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"关闭菜单栏"},on:{click:function(e){return t.WebMenubar(!1)}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"打开菜单栏"},on:{click:function(e){return t.WebMenubar(!0)}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"关闭工具栏"},on:{click:function(e){return t.WebToolbar(!1)}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"打开工具栏"},on:{click:function(e){return t.WebToolbar(!0)}}}),i("br"),t._v(" ["),i("b",{staticStyle:{color:"green"}},[t._v("文档视图")]),t._v("]"),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"普通视图"},on:{click:function(e){return t.WebShowView(1)}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"大纲视图"},on:{click:function(e){return t.WebShowView(2)}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"页面视图"},on:{click:function(e){return t.WebShowView(3)}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"打印预览"},on:{click:function(e){return t.WebShowView(4)}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"主控视图"},on:{click:function(e){return t.WebShowView(5)}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"WEB视图"},on:{click:function(e){return t.WebShowView(6)}}}),i("br"),i("input",{staticClass:"button",attrs:{type:"button",value:"阅读视图"},on:{click:function(e){return t.WebShowView(7)}}}),i("br")]),i("td",{attrs:{valign:"top"}}),i("td",{attrs:{valign:"top"}})])])]),t._m(0),i("td",{attrs:{valign:"top",width:"180",bgcolor:"white",align:"center"}},[i("table",{attrs:{id:"tablebut",width:"180"}},[1!=t.ishow?i("tr",{attrs:{width:"180"}},[i("td",{attrs:{valign:"top"}},[i("input",{staticClass:"button",staticStyle:{"margin-top":"20%"},attrs:{type:"button",value:"保存"},on:{click:function(e){return t.WebSaveC()}}}),i("br"),i("br")])]):t._e(),"true"==t.ishowAlgin?i("tr",{attrs:{width:"180"}},[i("td",{attrs:{valign:"top"}},[i("input",{staticClass:"button",staticStyle:{"margin-top":"20%"},attrs:{type:"button",value:"再次提交"},on:{click:function(e){return t.Examine()}}}),i("br"),i("br")])]):t._e(),1==t.ishow?i("b",{staticStyle:{color:"green"}},[t._v("处理意见")]):t._e(),i("br"),1==t.ishow?i("div",{ref:"borderBoxs",staticClass:"borderBoxs"},t._l(t.borderBoxs,(function(e,s){return i("div",{key:s,staticClass:"borderBox",class:s===t.borderBoxs.length-1?"col":""},[i("span",{staticStyle:{"font-size":"12px"}},[t._v("操作人 "+t._s(null!=e.reviewInfo?e.reviewInfo.userName:e.submitterInfo.userName))]),i("br"),i("span",{staticStyle:{"font-size":"12px"}},[t._v("备注："+t._s(null!=e.remarks?e.remarks:"-"))])])})),0):t._e(),1==t.ishow?i("el-input",{staticStyle:{"margin-bottom":"10px","margin-top":"10px"},attrs:{type:"textarea",rows:6,placeholder:"备注","show-word-limit":""},model:{value:t.remarks,callback:function(e){t.remarks=e},expression:"remarks"}}):t._e(),i("br"),1==t.ishow&&"true"!=t.ishowAlgin?i("tr",{attrs:{width:"180"}},[i("td",{attrs:{valign:"top"}},[i("div",[i("div",{staticStyle:{display:"flex","margin-top":"5px"}},[i("el-button",{staticStyle:{flex:"1"},attrs:{type:"success",size:"mini"},on:{click:function(e){return t.Examine()}}},[t._v("通过")])],1),i("div",{staticStyle:{display:"flex","margin-top":"5px"}},[i("el-button",{staticStyle:{flex:"1"},attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.Back()}}},[t._v("退回")]),i("el-button",{staticStyle:{flex:"1"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.deliver()}}},[t._v("转交")])],1),i("div",{staticStyle:{display:"flex","margin-top":"5px"}},[i("el-button",{staticStyle:{flex:"1"},attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.Nopass()}}},[t._v("不通过")])],1)])])]):t._e(),i("tr",[i("transition",{attrs:{name:"fade"}},[t.pass?i("div",{staticClass:"classsty"},[i("label",{staticStyle:{color:"green",margin:"5px 0",display:"block"}},[t._v("审核人列表")]),i("el-checkbox-group",{on:{change:t.ladderChange},model:{value:t.goPass.ladder,callback:function(e){t.$set(t.goPass,"ladder",e)},expression:"goPass.ladder"}},t._l(t.goPassList,(function(e,s){return i("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.trueName))])})),1),i("span",{staticClass:"footer"},[i("el-button",{staticStyle:{flex:"1"},attrs:{size:"small"},on:{click:function(e){t.pass=!1}}},[t._v("取 消")]),i("el-button",{staticStyle:{flex:"1"},attrs:{type:"primary",size:"small"},on:{click:t.GoPassClick}},[t._v("确 定")])],1)],1):t._e(),t.back?i("div",{staticClass:"classsty"},[i("label",{staticStyle:{color:"green",margin:"5px 0",display:"block"}},[t._v("退回人列表")]),i("el-checkbox-group",{on:{change:t.ladderBackChange},model:{value:t.goBack.ladder,callback:function(e){t.$set(t.goBack,"ladder",e)},expression:"goBack.ladder"}},t._l(t.goBackList,(function(e,s){return i("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.trueName+"("+e.roleIdMap.name+")"))])})),1),i("span",{staticClass:"footer"},[i("el-button",{staticStyle:{flex:"1"},attrs:{size:"small"},on:{click:function(e){t.back=!1}}},[t._v("取 消")]),i("el-button",{staticStyle:{flex:"1"},attrs:{type:"primary",size:"small"},on:{click:t.GoBackClick}},[t._v("确 定")])],1)],1):t._e(),t.Turn?i("div",{staticClass:"classsty"},[i("label",{staticStyle:{color:"green",margin:"5px 0",display:"block"}},[t._v("转交用户列表")]),i("el-checkbox-group",{on:{change:t.ladderTurnChange},model:{value:t.lessonForm.ladder,callback:function(e){t.$set(t.lessonForm,"ladder",e)},expression:"lessonForm.ladder"}},t._l(t.ladderList,(function(e,s){return i("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.trueName+"("+e.roleIdMap.name+")"))])})),1),0==t.ladderList.length?i("div",[t._v("暂无可转交用户")]):t._e(),i("span",{staticClass:"footer"},[i("el-button",{staticStyle:{flex:"1"},attrs:{size:"small"},on:{click:function(e){t.Turn=!1}}},[t._v("取 消")]),i("el-button",{staticStyle:{flex:"1"},attrs:{type:"primary",size:"small"},on:{click:t.GoTurnClick}},[t._v("确 定")])],1)],1):t._e()])],1)],1)])])])])},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("td",{attrs:{valign:"top",bgcolor:"white"}},[i("div",{attrs:{id:"WebOCX"}},[i("object",{attrs:{classid:"clsid:FF09E4FA-BFAA-486E-ACB4-86EB0AE875D5",codebase:"http://www.officectrl.com/weboffice/WebOffice.ocx#Version=2018,1,6,2",id:"WebOffice",width:"80%",height:"900"}},[i("param",{attrs:{name:"BorderStyle",value:"1"}}),i("param",{attrs:{name:"Menubar",value:"1"}}),i("param",{attrs:{name:"Titlebar",value:"1"}}),i("param",{attrs:{name:"Toolbars",value:"1"}})])])])}],a=i("1da1"),o=(i("96cf"),i("ac1f"),i("1276"),i("d81d"),i("99af"),i("d3b7"),i("25f0"),i("c2fa")),c=i("70f3"),r="",l="",u={data:function(){return{timer:null,ishow:!0,pass:!1,back:!1,Turn:!1,goPassList:[],goPass:{ladder:[]},goBackList:[],goBack:{ladder:[]},ladderList:[],lessonForm:{ladder:[]},ishowAlgin:null,remarks:"",borderBoxs:[]}},created:function(){this.$store.commit("app/TRUNOFF",!1)},mounted:function(){this.$nextTick((function(){o["a"](WebOCX);var t=window.location.hash.split("?")[1].split("&")[1].split("=")[1],e=window.location.hash.split("?")[1].split("&")[2].split("=")[1],i=window.location.hash.split("?")[1].split("&")[6].split("=")[1];this.ishow=e,this.ishowAlgin=i,r="http://140.249.209.176:8084/LightningDetection/quotation/".concat(t),WebOffice.UserName="杞人气象科技服务(北京)有限公司",WebOffice.Authorizer="www.officectrl.com",l="doc",clearTimeout(this.timer),this.timer=setTimeout((function(){WebOffice.Open(r,!0,l)}),500),this.WebTitlebar(!1),this.getAdministrators(),this.getAdministratorstwo(),this.getBackUser(),this.quotationExamineRecord()}))},methods:{NoCopyIt:function(t){o["c"](t)},WebSignature:function(t){var e;1==t&&(e="001.gif"),2==t&&(e="002.gif"),3==t&&(e="003.gif"),o["b"]("http://www.officectrl.com/weboffice/images/"+e)},WebSave:function(){WebOffice.Save("http://www.officectrl.com/officecs/uploadedit.aspx?oper=edit&flsid=4167975720113410419&flag=1")},WebHttpSave:function(){WebOffice.HttpInit(),WebOffice.HttpAddPostString("filename","4167975720113410419.doc"),WebOffice.HttpAddPostCurrFile("docfile","");var t=WebOffice.HttpPost("http://www.officectrl.com/officecs/postsave.aspx");"ok"==t&&alert("保存成功！")},WebDocReload:function(){location.reload()},WebOpen1:function(){WebOffice.WebLoadFile("http://www.officectrl.com/weboffice/temp/%E6%95%B0%E6%8D%AE%E6%99%BA%E8%83%BD%E8%AF%86%E5%88%AB%E4%B8%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%98%E5%82%A8%E8%A1%A8%E6%A0%BC%E6%95%B0%E6%8D%AE%E7%AE%97%E6%B3%95%2Edocx","Word.Document")},WebOpen2:function(){WebOffice.Close(),WebOffice.WebOpen("http://www.officectrl.com/weboffice/temp/file1.doc","doc")},WebOpen3:function(){WebOffice.WebLoadFile("http://www.officectrl.com/weboffice/temp/file1.doc",null)},CreateXLS:function(){WebOffice.WebLoadFile("","xls")},CreateDoc:function(){WebOffice.WebLoadFile("","doc")},CreatePpt:function(){WebOffice.WebLoadFile("","ppt")},getAdministrators:function(){var t=this;this.goPassList=[];var e=window.location.hash.split("?")[1].split("&")[3].split("=")[1];Object(c["m"])({regionId:e,parent:1}).then((function(e){e.data.records.map((function(e){t.goPassList.push(e)}))}))},getAdministratorstwo:function(){var t=this;this.ladderList=[];var e=window.location.hash.split("?")[1].split("&")[3].split("=")[1],i=window.location.hash.split("?")[1].split("&")[4].split("=")[1];Object(c["m"])({regionId:e,parent:0}).then((function(e){e.data.records.map((function(e){i!=e.id&&t.ladderList.push(e)}))}))},getBackUser:function(){var t=this;this.goBackList=[];var e=window.location.hash.split("?")[1].split("&")[5].split("=")[1],i=window.location.hash.split("?")[1].split("&")[4].split("=")[1];Object(c["n"])({id:e,userId:i}).then((function(e){e.data.records.map((function(e){t.goBackList.push(e)}))}))},WebSaveC:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var i,s,n,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=window.location.hash.split("?")[1].split("&")[0].split("=")[1],s=window.location.hash.split("?")[1].split("&")[4].split("=")[1],n=WebOffice.Save("http://140.249.209.176:8084/LightningDetection/quotation/updateQuotationFile?id=".concat(i)),a=n.substring(0,3),"200"==a?(t.$message.success("保存成功,需要关闭页面以提高文件正确性。"),o={sendType:1,acceptUserIds:s,messageStr:"4"},Object(c["N"])(o).then((function(t){})),window.close()):t.$message.error("保存失败");case 5:case"end":return e.stop()}}),e)})))()},Examine:function(){var t=window.location.hash.split("?")[1].split("&")[3].split("=")[1],e=window.location.hash.split("?")[1].split("&")[0].split("=")[1],i=window.location.hash.split("?")[1].split("&")[4].split("=")[1];if("2841"==t||"true"==this.ishowAlgin){var s=WebOffice.Save("http://140.249.209.176:8084/LightningDetection/quotationExamine/examine?state=".concat(1,"&id=",e)),n=s.substring(0,3);if("200"==n){this.$message.success("通过成功,需要关闭页面以提高文件正确性。");var a={sendType:1,acceptUserIds:i,messageStr:"4"};Object(c["N"])(a).then((function(t){})),window.close()}else this.$message.error("请退出后重试")}else this.pass=!0},Back:function(){this.back=!0},deliver:function(){this.Turn=!0},Nopass:function(){var t=window.location.hash.split("?")[1].split("&")[0].split("=")[1],e=window.location.hash.split("?")[1].split("&")[4].split("=")[1],i=WebOffice.Save("http://140.249.209.176:8084/LightningDetection/quotationExamine/examine?state=".concat(2,"&id=",t)),s=i.substring(0,3);if("200"==s){this.$message.success("不通过成功,需要关闭页面以提高文件正确性。");var n={sendType:1,acceptUserIds:e,messageStr:"4"};Object(c["N"])(n).then((function(t){})),window.close()}else this.$message.error("请退出后重试")},ladderChange:function(){this.goPass.ladder.length>1&&this.goPass.ladder.shift()},ladderBackChange:function(){this.goBack.ladder.length>1&&this.goBack.ladder.shift()},ladderTurnChange:function(){this.lessonForm.ladder.length>1&&this.lessonForm.ladder.shift()},GoPassClick:function(){var t=window.location.hash.split("?")[1].split("&")[0].split("=")[1],e=window.location.hash.split("?")[1].split("&")[4].split("=")[1];if(0==this.goPass.ladder.length)this.$message("请先选择审核人");else{var i=WebOffice.Save("http://140.249.209.176:8084/LightningDetection/quotationExamine/examine?state=".concat(1,"&id=",t,"&Reviewer=").concat(this.goPass.ladder.toString(),"&remarks=").concat(this.remarks)),s=i.substring(0,3);if("200"==s){this.$message.success("提交成功,需要关闭页面以提高文件正确性。");var n={sendType:1,acceptUserIds:e,messageStr:"4"};Object(c["N"])(n).then((function(t){})),window.close()}else this.$message.error("请退出后重试")}},GoBackClick:function(){var t=window.location.hash.split("?")[1].split("&")[0].split("=")[1],e=window.location.hash.split("?")[1].split("&")[4].split("=")[1];if(0==this.goBack.ladder.length)this.$message("请先选择退回用户");else{var i=WebOffice.Save("http://140.249.209.176:8084/LightningDetection/quotationExamine/examine?state=".concat(3,"&id=",t,"&Reviewer=").concat(this.goBack.ladder.toString(),"&remarks=").concat(this.remarks)),s=i.substring(0,3);if("200"==s){this.$message.success("退回成功,需要关闭页面以提高文件正确性。");var n={sendType:1,acceptUserIds:e,messageStr:"4"};Object(c["N"])(n).then((function(t){})),window.close()}else this.$message.error("请退出后重试")}},GoTurnClick:function(){var t=window.location.hash.split("?")[1].split("&")[0].split("=")[1],e=window.location.hash.split("?")[1].split("&")[4].split("=")[1];if(0==this.lessonForm.ladder.length)this.$message("请先选择转交用户");else{var i=WebOffice.Save("http://140.249.209.176:8084/LightningDetection/quotationExamine/examine?state=".concat(4,"&id=",t,"&Reviewer=").concat(this.lessonForm.ladder.toString(),"&remarks=").concat(this.remarks)),s=i.substring(0,3);if("200"==s){this.$message.success("转交成功,需要关闭页面以提高文件正确性。");var n={sendType:1,acceptUserIds:e,messageStr:"4"};Object(c["N"])(n).then((function(t){})),window.close()}else this.$message.error("请退出后重试")}},quotationExamineRecord:function(){var t=this,e=window.location.hash.split("?")[1].split("&")[5].split("=")[1];Object(c["A"])({id:e}).then((function(e){200==e.data.state&&(t.borderBoxs=e.data.records,setTimeout((function(){t.$refs.borderBoxs.scrollTop=t.$refs.borderBoxs.scrollHeight}),500))}))},WebSaveLocal:function(){WebOffice.showdialog(3)},WebSavePage:function(){WebOffice.SetPageAs("c:\\b.doc",1,0),alert("已将文档第1页的内容另存为c盘根目录下的b.doc文件")},WebDelFile:function(){WebOffice.DeleteLocalFile("c:\\a.doc"),alert("已将c盘根目a.doc删除")},WebSaveLocalPdf:function(){var t="c:\\a.pdf",e=document.getElementById("WebOffice");e.ActiveDocument.ExportAsFixedFormat(t,17),alert("已在C盘根目录下生成"+t+"，请到你本地电脑的C盘目录查看！")},WebSaveLocalHTML:function(){var t="c:\\a.html";WebOffice.ActiveDocument.saveas(t,8),alert("已在C盘根目录下生成"+t+"，请到你本地电脑的C盘目录查看！")},WebGetUser:function(){var t=WebOffice.GetApplication;alert("用Application对象取得当前WORD文档用户名是："+t.username)},WebActive:function(){WebOffice.WebDialogs(129)},WebTempPath:function(){var t=WebOffice.TempFilePath;alert(t)},WebDocPrintPreView:function(){WebOffice.ActiveDocument.Application.PrintPreview=1},WebDocPrint:function(){WebOffice.printout(!0)},WebDocPrint2:function(){WebOffice.ActiveDocument.Application.Dialogs(88).Show()},WebPrintDirc:function(){WebOffice.ActiveDocument.PrintOut()},WebTitlebar:function(t){WebOffice.Titlebar=t},WebMenubar:function(t){WebOffice.MenuBars=t},WebToolbar:function(t){WebOffice.Toolbars=t},WebShowView:function(t){WebOffice.ShowView(t)}}},b=u,f=(i("f420"),i("2877")),p=Object(f["a"])(b,s,n,!1,null,"c6b45b94",null);e["default"]=p.exports},f420:function(t,e,i){"use strict";i("5bc0")}}]);